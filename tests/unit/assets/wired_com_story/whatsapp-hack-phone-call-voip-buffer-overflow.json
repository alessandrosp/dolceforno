{"authors": ["Lily Hay Newman"], "category": "security", "content": "You've heard the advice a million times. [Don't click links](https://www.wired.com/story/resist-phishing-attacks/) in suspicious emails or texts. Don't [download shady apps](https://www.wired.com/2016/12/never-ever-ever-download-android-apps-outside-google-play/). But a new _Financial Times_ [report](https://www.ft.com/content/4da1117e-756c-11e9-be7d-6d846537acab?) alleges that the notorious Israeli spy firm NSO Group developed a WhatsApp exploit that could inject malware onto targeted phones\u2014and steal data from them\u2014simply by calling them. The targets didn't need to pick up to be infected, and the calls often left no trace on the phone's log. But how would a hack like that even work in the first place?\n\nWhatsApp, which offers [encrypted messaging by default](https://www.wired.com/2016/04/forget-apple-vs-fbi-whatsapp-just-switched-encryption-billion-people/) to its 1.5 billion users worldwide, discovered the vulnerability in early May and released a patch for it on Monday. The Facebook-owned company told the _FT_ that it contacted a number of human rights groups about the issue and that exploitation of this vulnerability bears \"all the hallmarks of a private company known to work with governments to deliver spyware.\" In a statement, NSO Group denied any involvement in selecting or targeting victims but not its role in the creation of the hack itself.\n\n\"This does indeed sound like a freak incident.\"\n\nBjoern Rupp, CryptoPhone\n\nSo-called zero-day bugs, in which attackers find a vulnerability before the company can patch it, happen on every platform. It's part and parcel of software development; the trick is to close those security gaps as quickly as possible. Still, a hack that requires nothing but an incoming phone call seems uniquely challenging\u2014if not impossible\u2014to defend against.\n\nWhatsApp wouldn't elaborate to WIRED about how it discovered the bug or give specifics on how it works, but the company says it is doing infrastructure upgrades in addition to pushing a patch to ensure that customers can't be targeted with other phone-call bugs.\n\n\"Remote-exploitable bugs can exist in any application that receives data from untrusted sources,\" says Karsten Nohl, chief scientist at the German firm Security Research Labs. That includes WhatsApp calls, which use the voice-over-internet protocol to connect users. VoIP applications have to acknowledge incoming calls and notify you about them, even if you don't pick up. \"The more complex the data parsing, the more room for error,\" Nohl says. \"In the case of WhatsApp, the protocol for establishing a connection is rather complex, so there is definitely room for exploitable bugs that can be triggered without the other end picking up the call.\"\n\nVoIP calling services have been around for so long that you'd think any kinks in the basic call connection protocols would be worked out by now. But in practice, every service's implementation is a little bit different. Nohl points out that things get even trickier when you are offering [end-to-end encrypted calling](https://www.wired.com/2017/04/encrypted-chat-took-now-encrypted-callings-turn/), as WhatsApp famously does. While WhatsApp bases its end-to-end encryption on the Signal Protocol, its VoIP calling functionally likely also includes other proprietary code as well. Signal says that its service is not vulnerable to this calling attack.\n\nAccording to Facebook's [security advisory](https://www.facebook.com/security/advisories/cve-2019-3568), the WhatsApp vulnerability stemmed from an extremely common type of bug known as a buffer overflow. Apps have a sort of holding pen, called a buffer, to stash extra data. A popular class of attacks strategically overburdens that buffer so the data \"overflows\" into other parts of the memory. This can cause crashes or, in some cases, give attackers a foothold to gain more and more control. That's what happened with WhatsApp. The hack exploits the fact that in a VoIP call the system has to be primed for a range of possible inputs from the user: pick up, decline the call, and so on.\n\n\"This does indeed sound like a freak incident, but at the heart of it seems to be a buffer overflow problem that is unfortunately not too uncommon these days,\" says Bjoern Rupp, CEO of the German secure communication firm CryptoPhone. \"Security never was WhatsApp's primary design objective, which means WhatsApp has to rely on complex VoIP stacks that are known for having vulnerabilities.\"\n\nThe WhatsApp bug was being exploited to target only a small number of high-profile activists and political dissidents, so most people won't have been affected by any of this in practice. But you should still download the patch on your [Android](https://play.google.com/store/apps/details?id=com.whatsapp&hl=en_US) and [iOS](https://itunes.apple.com/us/app/whatsapp-messenger/id310633997?mt=8) devices.\n\n\"Companies like NSO Group try to keep a little stockpile of things that can be used to get onto devices,\" says John Scott-Railton, a senior researcher at the University of Toronto's Citizen Lab. \"This incident makes it abundantly clear that anyone with a phone is impacted by the kind of vulnerabilities that customers of these companies are slinging around. There\u2019s a reality here for all of us.\"\n\nIt\u2019s time to start using an encrypted messaging app. Why? Using end-to-end encryption means that no one can see what you\u2019re sharing back and forth.\n\n", "image": "https://media.wired.com/photos/5cdacf5e2c82ec474dc7bbda/master/w_2400,c_limit/phonecall-1127496509.jpg", "published": "2019-05-14", "tags": ["WhatsApp", "hacks", "messaging"], "title": "How Hackers Broke WhatsApp With Just a Phone Call"}